#Область ОбработчикиСобытийФормы

&НаСервере
&После("ПриСозданииНаСервере")
Процедура ИБС_ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	// + ИБС, Сушинцев А.А. НСИ_07, 5617 26.08.2021
	Элемент 			= Элементы.Вставить("ИБС_МаркаАвтомобиля", Тип("ПолеФормы"), Элементы.КодМарка, Элементы.Марка);
	Элемент.Вид 		= ВидПоляФормы.ПолеВвода;
	Элемент.ПутьКДанным = "Объект.ИБС_МаркаАвтомобиля";
	
	Элементы.Марка.Видимость = Ложь;
	// - ИБС, Сушинцев А.А. 26.08.2021.
	
	// + ИБС, Филиппова О.Е. ТРЛ01 5859 10.09.2021
	МассивЭлементов = Новый Массив();
	МассивЭлементов.Добавить("Прицеп");
	МассивЭлементов.Добавить("ГосударственныйНомерПрицепа");
	ОбщегоНазначенияУТКлиентСервер.УстановитьСвойствоЭлементовФормы(Элементы, МассивЭлементов, "Видимость", Ложь);	
	
	Элементы.ВидПеревозки.Заголовок = "Вариант перевозки";
	
	ГруппаПрицеп = Элементы.ГруппаПрицеп;
	
	ИБС_Прицеп             = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_Прицеп", ГруппаПрицеп, "Объект.ИБС_Прицеп", "Прицеп",ВидПоляФормы.ПолеВвода);
	ИБС_ПрицепОбязательный = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_ПрицепОбязательный", ГруппаПрицеп, "Объект.ИБС_ПрицепОбязательный", "Обязателен прицеп",ВидПоляФормы.ПолеФлажка);
	ИБС_ПрицепОбязательный.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Право;

	ГрузоподъемностьВместимость = Элементы.ГрузоподъемностьВместимость;
	ИБС_МаксимальнаяГрузоподъемность = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_МаксимальнаяГрузоподъемность", ГрузоподъемностьВместимость, "Объект.ИБС_МаксимальнаяГрузоподъемность",,ВидПоляФормы.ПолеВвода);
	ИБС_МаксГрузоподъемностьЕдИзм = ИБС_РаботаСФормой.СоздатьДекорациюФормы(Элементы,"ИБС_МаксГрузоподъемностьЕдИзм","кг",ВидДекорацииФормы.Надпись,ГрузоподъемностьВместимость);
	
	ИБС_МассаНагрузки = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_МассаБезНагрузки", ГрузоподъемностьВместимость, "Объект.ИБС_МассаБезНагрузки",,ВидПоляФормы.ПолеВвода);
	ИБС_МассаНагрузкиЕдИзм = ИБС_РаботаСФормой.СоздатьДекорациюФормы(Элементы,"ИБС_МассаНагрузкиЕдИзм","кг",ВидДекорацииФормы.Надпись,ГрузоподъемностьВместимость);
	
	ГруппаДобавленныеРеквизиты = ИБС_РаботаСФормой.ДобавитьГруппуФормы(ЭтотОбъект,"ИБС_ГруппаДобавленныеРеквизиты",,,ГруппировкаПодчиненныхЭлементовФормы.ГоризонтальнаяВсегда);
	ГруппаДобавленныеРеквизиты.СквозноеВыравнивание = СквозноеВыравнивание.Использовать;
	ГруппаДобавленныеРеквизиты.Объединенная = Истина;
	
	ДобавленныеРеквизитыЛево = ИБС_РаботаСФормой.ДобавитьГруппуФормы(ЭтотОбъект,"ИБС_ГруппаДобавленныеРеквизитыЛево",ГруппаДобавленныеРеквизиты,,ГруппировкаПодчиненныхЭлементовФормы.Вертикальная);
	ДобавленныеРеквизитыЛево.СквозноеВыравнивание = СквозноеВыравнивание.Использовать;
	ДобавленныеРеквизитыЛево.Объединенная = Истина;

	ДобавленныеРеквизитыПраво = ИБС_РаботаСФормой.ДобавитьГруппуФормы(ЭтотОбъект,"ИБС_ГруппаДобавленныеРеквизитыПраво",ГруппаДобавленныеРеквизиты,,ГруппировкаПодчиненныхЭлементовФормы.Вертикальная);
	ДобавленныеРеквизитыПраво.СквозноеВыравнивание = СквозноеВыравнивание.Использовать;
	ДобавленныеРеквизитыПраво.Объединенная = Истина;
	
	ИБС_ВидВладения = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_ВидВладения", ДобавленныеРеквизитыЛево, "Объект.ИБС_ВидВладения", "Вид владения",ВидПоляФормы.ПолеВвода);
	
	ИБС_ВидПеревозки = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_ВидПеревозки", ДобавленныеРеквизитыЛево, "Объект.ИБС_ВидПеревозки", "Вид перевозки",ВидПоляФормы.ПолеВвода);
	ИБС_ВидПеревозки.УстановитьДействие("ПриИзменении","ИБС_ВидПеревозкиПриИзменении");									

	ИБС_МестоДислокации = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_МестоДислокации", ДобавленныеРеквизитыЛево, "Объект.ИБС_МестоДислокации", "Место дислокации",ВидПоляФормы.ПолеВвода);
	
	ИБС_Наемный = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_Наемный", ДобавленныеРеквизитыЛево, "Объект.ИБС_Наемный", "Наемный",ВидПоляФормы.ПолеФлажка);
	ИБС_Наемный.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Право;
	
	ИБС_АвтомобильОС = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_АвтомобильОС", ДобавленныеРеквизитыПраво, "Объект.ИБС_АвтомобильОС",,ВидПоляФормы.ПолеВвода);
	ИБС_БалансодержательАвтомобиля = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_БалансодержательАвтомобиля", ДобавленныеРеквизитыПраво, "Объект.ИБС_БалансодержательАвтомобиля",,ВидПоляФормы.ПолеВвода);
	ИБС_ПодразделениеОрганизации = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_ПодразделениеОрганизации", ДобавленныеРеквизитыПраво, "Объект.ИБС_ПодразделениеОрганизации",,ВидПоляФормы.ПолеВвода);
	ИБС_ОтветственныйЗаОсновноеСредство = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект,"ИБС_ОтветственныйЗаОсновноеСредство", ДобавленныеРеквизитыПраво, "Объект.ИБС_ОтветственныйЗаОсновноеСредство",,ВидПоляФормы.ПолеВвода);
	
	ГруппаПлощадки = ИБС_РаботаСФормой.ДобавитьГруппуФормы(ЭтотОбъект,"ИБС_ГруппаПлощадки",,,ГруппировкаПодчиненныхЭлементовФормы.ГоризонтальнаяВсегда);
	ГруппаДобавленныеРеквизиты.СквозноеВыравнивание = СквозноеВыравнивание.Использовать;
	ГруппаДобавленныеРеквизиты.Объединенная = Истина;
	//ИБС_Площадки = ФормыУХ.СоздатьТаблицуФормы(Элементы,"ИБС_Площадки",,"Объект.ИБС_Площадки",ГруппаПлощадки);
	//Площадка = ФормыУХ.СоздатьПолеФормы(Элементы,"ИБС_ПлощадкиПлощадка","Закреплено за площадками","Объект.ИБС_Площадки.Площадка",ВидПоляФормы.ПолеВвода,ИБС_Площадки);
	// - ИБС, Филиппова О.Е. 10.09.2021
	
	// ИБС+[Задача № 7112] Данилин В.И. от 30.12.2021. Добавлено:{
	
	МассивКолонок = новый Массив;	
	МассивКолонок.Добавить("Период");
	МассивКолонок.Добавить("Ферма");
	//МассивКолонок.Добавить("ТранспортноеСредство");
	МассивКолонок.Добавить("Закреплен");	
	ИБС_РаботаСФормой.СозданиеДинамическогоСписка(ЭтотОбъект,"ИБС_ДинСписок_Площадки",,МассивКолонок,,"РегистрСведений.ИБС_ЗакреплениеТС_ЗаПлощадками",,,Ложь);
	ЭтотОбъект.Элементы.ИБС_ДинСписок_Площадки.Высота = 5;
	ОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбораДинамическогоСписка(
		ЭтотОбъект.ИБС_ДинСписок_Площадки,
		"ТранспортноеСредство",
		Объект.Ссылка,
		ВидСравненияКомпоновкиДанных.Равно,,
		Истина);

	// } ИБС-[Задача № 7112] Данилин В.И. от 30.12.2021.	
	
	// + ИБС, Ярцев Р.Ю., ТРЛ_02, 6060 10.11.2021
	нЭлемент = ИБС_РаботаСФормой.ДобавитьПолеФормы(ЭтотОбъект, "ИБС_ЭтоПрицеп", ГруппаПрицеп, "Объект.ИБС_ЭтоПрицеп", "Прицеп", ВидПоляФормы.ПолеФлажка);
	Элементы.Переместить(нЭлемент, ГруппаПрицеп, ИБС_Прицеп);  
	нЭлемент.ПоложениеЗаголовка = ПоложениеЗаголовкаЭлементаФормы.Право;
	нЭлемент.УстановитьДействие("ПриИзменении", "ИБС_ЭтоПрицепПриИзменении");
	// - ИБС, Ярцев Р.Ю., ТРЛ_02, 6060 10.11.2021
	
	// + ИБС, Сидорова Н.В. Отработка замечаний по общим доработкам блока ТРЛ, 7112 08.12.2021
	Элементы.ИБС_МаркаАвтомобиля.УстановитьДействие("ПриИзменении","МаркаПриИзменении");
	
	ИБС_РаботаСФормой.ВставитьПолеФормы(ЭтотОбъект,"ИБС_ВместимостьПассажиров",Элементы.ГрузоподъемностьВместимость,"Объект.ИБС_ВместимостьПассажиров","Вместимость пассажиров",ВидПоляФормы.ПолеВвода);
	Элементы.ИБС_ВместимостьПассажиров.КнопкаВыбора = Истина;
	
	ИБС_УстановитьВидимостьВместимостьПассажиров();
	// - ИБС, Сидорова Н.В. 08.12.2021. 
КонецПроцедуры

&НаКлиенте
Процедура ИБС_ПриОткрытииПосле(Отказ)
	Если Объект.ИБС_ЭтоПрицеп Тогда
		Элементы.ИБС_Прицеп.Видимость = Ложь;
		Элементы.ИБС_ПрицепОбязательный.Видимость = Ложь;
	КонецЕсли;
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовФормы

// + ИБС, Ярцев Р.Ю., ТРЛ_02, 6060 10.11.2021
&НаКлиенте
Процедура ИБС_ЭтоПрицепПриИзменении(Элемент)
	Если Объект.ИБС_ЭтоПрицеп Тогда
		Объект.ИБС_Прицеп = ПредопределенноеЗначение("Справочник.ТранспортныеСредства.ПустаяСсылка"); 
		Объект.ИБС_ПрицепОбязательный = Ложь;
		Элементы.ИБС_Прицеп.Видимость = Ложь;
		Элементы.ИБС_ПрицепОбязательный.Видимость = Ложь;
	Иначе
		Элементы.ИБС_Прицеп.Видимость = Истина;
		Элементы.ИБС_ПрицепОбязательный.Видимость = Истина;
	КонецЕсли;
КонецПроцедуры
// - ИБС, Ярцев Р.Ю., ТРЛ_02, 6060 10.11.2021


// + ИБС, Филиппова О.Е. ТРЛ01 5859 10.09.2021
&НаКлиенте
Процедура ИБС_ВидПеревозкиПриИзменении(Элемент)
	
	УстановитьВидимостьДоступностьПриИзмененииВидаПеревозки();
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура УстановитьВидимостьДоступностьНаСервере()
	
	УстановитьВидимостьДоступностьПриИзмененииВидаПеревозки();	
	
КонецПроцедуры

&НаСервере
Процедура УстановитьВидимостьДоступностьПриИзмененииВидаПеревозки()
	
	Объект.ИБС_ПрицепОбязательный = Объект.ИБС_ВидПеревозки.ПрицепОбязательный;		
	
КонецПроцедуры

// - ИБС, Филиппова О.Е. 10.09.2021

// + ИБС, Сидорова Н.В. Отработка замечаний по общим доработкам блока ТРЛ, 7112 08.12.2021
&НаКлиенте
&После("СформироватьНаименование")
Процедура ИБС_СформироватьНаименование()
	Объект.Наименование = СокрЛП(Объект.Код) + " " + СокрЛП(Объект.ИБС_МаркаАвтомобиля);
КонецПроцедуры

&НаСервере
Процедура ИБС_УстановитьВидимостьВместимостьПассажиров()
	Если ЗначениеЗаполнено(Объект.Тип) и СтрНайти(НРег(Объект.Тип.Наименование),"автобус")>0 Тогда
		Элементы.ИБС_ВместимостьПассажиров.Видимость = Истина;
	Иначе
		Элементы.ИБС_ВместимостьПассажиров.Видимость = Ложь;
	КонецЕсли;
КонецПроцедуры

&НаКлиенте
&Перед("ТипПриИзменении")
Процедура ИБС_ТипПриИзмененииПеред(Элемент)
	ИБС_УстановитьВидимостьВместимостьПассажиров();
КонецПроцедуры

// - ИБС, Сидорова Н.В. 08.12.2021. 




#КонецОбласти
